<system>
  log_level debug
</system>

<source>
  @type tail
  path /dionaea/lib/dionaea/dionaea_output.json
  pos_file /dionaea/lib/dionaea/log.json.pos
  tag dionaea
  format json
  <parse>
    @type json
  </parse>
</source>

<match dionaea>
  @type elasticsearch
  host https://cynergizer-ce1e21.es.us-central1.gcp.cloud.es.io:9243
  index_name 62558e285529969891a081a3`dionaea_requests
  user *****
  password *****
</match>


<source>
  @type tail
  path /opt/snare/snare_log.json
  pos_file /opt/snare/log.json.pos
  tag snare
  format json
  <parse>
    @type json
  </parse>
</source>

<filter snare>
  @type rename_key
  rename_rule1 destination_IP attackerIP
  rename_rule2 timestamp datetime
  rename_rule3 request payload
</filter>

<filter snare>
  @type record_transformer
  remove_keys method,http,status,dump
</filter>

<match snare>
  @type elasticsearch
  host https://cynergizer-ce1e21.es.us-central1.gcp.cloud.es.io:9243
  index_name 62558e285529969891a081a3`web_requests
  user *****
  password *****
</match>

<source>
  @type tail
  path /opt/cowrie/log/cowrie.json
  pos_file /opt/cowrie/log/log.json.pos
  tag cowrie
  format json
</source>

<match cowrie>
  @type elasticsearch
  host https://cynergizer-ce1e21.es.us-central1.gcp.cloud.es.io:9243
  index_name 62558e285529969891a081a3`cowrie_requests
  user *****
  password *****
</match>

<source>
  @type tail
  path /var/log/kern.json
  pos_file /var/log/log.pos
  tag iptable
  format json
</source>

<filter iptable>
  @type rename_key
  rename_rule4 dpt d_port
  rename_rule5 proto protocol
  rename_rule6 src source_ip
  rename_rule7 date_time datetime
</filter>

<filter snare>
  @type record_transformer
  remove_keys source,spt,dst,len
</filter>

<match iptable>
  @type elasticsearch
  host cynergizer-ce1e21.es.us-central1.gcp.cloud.es.io
  port 9243
  scheme https
  index_name 62558e285529969891a081a3`iptable_requests
  user *****
  password *****
</match>
